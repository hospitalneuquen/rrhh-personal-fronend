<header class="d-flex flex-row justify-content-between subheader">
    <div>
        <h5>Últimas ausencias</h5>
    </div>
    <div class="d-flex flex-row justify-content-end">
        <plex-button
            title="Ver Agente Detalle"
            type="info"
            size="sm"
            class="mr-2"
            icon="mdi mdi-eye"
            [routerLink]="['/agentes/registro', agente?._id]">
        </plex-button>
        <plex-button
            title="Ver Indicadores"
            type="success"
            size="sm"
            class="mr-2"
            icon="mdi mdi-chart-bar"
            (click)="verIndicadores()">
        </plex-button>
        <plex-button
            title="Cerrar"
            type="danger"
            icon="mdi mdi-close"
            size="sm"
            routerLink="/agentes">
        </plex-button>
    </div>
</header>
<section class="d-flex flex-row mt-2" *ngIf="agente">
    <div class="d-flex flex-column align-items-center mt-2 mr-4">
        <app-agente-foto
            [foto]="agente.foto"
            [agente]="agente">
        </app-agente-foto>
    </div>
    <article class="d-flex flex-column">
        <div class="d-flex flex-row">
            <plex-badge type="info">
                {{ agente.situacionLaboral.situacion? (agente.situacionLaboral.situacion.tipoSituacion | title:'nombre') : 'Sin Situacion'}}
            </plex-badge>
            <plex-badge [type]="agente.activo? 'success': 'danger'">
                    {{ agente.activo? 'Activo' : 'Baja' }}
            </plex-badge>
        </div>
        <h3 class="mt-2 mb-4">
            {{ agente.nombre }}<br>
            <strong>{{ agente.apellido }}</strong>
        </h3>
    </article>
</section>
<app-ausentismo-search-form
    *ngIf="agente"
    [agente]="agente"
    (searchStart)="waitingResultados($event)"
    (searchEnd)="showResultados($event)"
    (searchClear)="clearResultados($event)">
</app-ausentismo-search-form>
<br>
<ng-container *ngIf="searching; then mostrarSearchingActivity; else mostrarResultados"></ng-container>

<ng-template #mostrarSearchingActivity>
    <plex-loader 
        class="d-flex flex-column align-items-center justify-content-center h-75"
        type="ball-beat">
    </plex-loader>
</ng-template>

<ng-template #mostrarResultados>
    <app-ausentismo-listado
        *ngIf="ausentismos"
        [items]="ausentismos"
        (selected)="seleccionarAusentismo($event)"
        (edit)="editarAusentismo($event)"
        (delete)="eliminarAusentismo($event)">
    </app-ausentismo-listado>
    <app-search-leyenda
        *ngIf="!ausentismos?.length"
        [header]="'No se encontraron resultados!'"
        [subHeader]="'Podes refinar tu búsqueda modificando los filtros'">
    </app-search-leyenda>
</ng-template>

